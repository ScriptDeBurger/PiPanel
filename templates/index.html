<!DOCTYPE html>
<html>
<head>
    <title>Spotify Dashboard</title>
    <style>
      #bar { width:100%; height:20px; background:#ddd; border-radius:5px; margin-top:10px; }
      #progress { height:20px; width:0; background:#4caf50; border-radius:5px; }
    </style>
</head>
<body>
    <h1>Spotify Mini Player</h1>
    <button onclick="location.href='/spotify/play'">▶️ Play</button>
    <button onclick="location.href='/spotify/pause'">⏸️ Pause</button>
    <button onclick="location.href='/spotify/prev'">⏮️ Prev</button>
    <button onclick="location.href='/spotify/next'">⏭️ Next</button>

    <div id="bar"><div id="progress"></div></div>
    <p id="time">0:00 / 0:00</p>
    <p id="song">Song: -</p>
    <p id="artist">Artist: -</p>
    <img id="album-art" src="" width="200px">

<script>
async function updateStatus() {
    const res = await fetch("/spotify/status");
    const data = await res.json();

    document.getElementById("album-art").src = data.album_img;
    document.getElementById("song").textContent = "Song: " + data.name;
    document.getElementById("artist").textContent = "Artist: " + data.artist;

    let percent = (data.progress / data.duration) * 100;
    document.getElementById("progress").style.width = percent + "%";

    function fmt(s) {
        const m = Math.floor(s/60);
        const sec = Math.floor(s%60).toString().padStart(2,"0");
        return `${m}:${sec}`;
    }
    document.getElementById("time").textContent = fmt(data.progress) + " / " + fmt(data.duration);
}
setInterval(updateStatus, 1000);
updateStatus();
</script>
</body>
</html>
